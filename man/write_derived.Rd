% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write-derived.R
\name{write_derived}
\alias{write_derived}
\title{Write a derived data set and corresponding metadata}
\usage{
write_derived(
  .data,
  .spec,
  .file,
  .subject_col = "ID",
  .prev_file = NULL,
  .compare_from_svn = TRUE,
  .return_base_compare = FALSE,
  .execute_diffs = TRUE
)
}
\arguments{
\item{.data}{a data frame}

\item{.spec}{a yspec object}

\item{.file}{csv file name to write out to (including path)}

\item{.subject_col}{subject column name (defaults to ID)}

\item{.prev_file}{csv file name of previous version (defaults to .file)}

\item{.compare_from_svn}{logical. Should the data comparison be done on the latest svn version? (If not, local version is used)}

\item{.return_base_compare}{logical. Should the two current and previous versions of the datasets be returned?}

\item{.execute_diffs}{logical. Should the diffs be executed?}
}
\description{
This function will take a data frame in R and write it out to csv.
It also creates a metadata folder, storing the xpt file along with other useful information.

The csv and spec-list.yml are always written. The xpt, define document, and
last-run-summary.txt are only regenerated when the csv or spec-list.yml
content has changed, avoiding unnecessary diffs in version control from
embedded timestamps.

last-run-summary.txt includes separate sections for data changes and
spec-list changes (added/removed variables and updated spec fields).
The same summary content is always printed to the console; the file is only
overwritten when at least one data/spec diff exists.

If a legacy metadata folder containing diffs.csv is detected, the metadata
folder is removed and recreated before writing new outputs.
}
\examples{
\dontrun{
nm_spec <- yspec::ys_load(system.file("derived", "pk.yml", package = "mrgda"))
nm <- readr::read_csv(system.file("derived", "pk.csv", package = "mrgda"), na = ".")
write_derived(.data = nm, .spec = nm_spec, .file = "data/derived/pk.csv")
}
}
